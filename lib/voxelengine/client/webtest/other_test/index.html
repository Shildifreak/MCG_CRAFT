<html>
	<head>
		<meta charset="utf-8">
		<style>
			body {
				height: 100vh;
				padding: 0;
				margin: 0;
			}
			#logbox {
				position: absolute;
				overflow-y: scroll;
				width: 20em;
				height: 100vh;
				padding: 0;
				margin: 0;
			}
			#gamebox {
				position: absolute;
				width: calc(100vw - 20em);
				height: 100vh;
				padding: 0;
				padding-left:20em;
				margin: 0;
			}
		</style>
	</head>

	<body>

	<div id="logbox">
	</div>
	
	<div id="gamebox">
		<object data="http://mcgcraft.de" type="text/html" name="example" style="width:100%; height:100%; padding:0; margin:0">
		</object>
	</div>

	<script type="text/javascript">
		var logbox = document.getElementById("logbox");
		
		var queryDict = {};
		location.search.substr(1).split("&").forEach(function(item) {queryDict[item.split("=")[0]] = item.split("=")[1]});
		
		var address = "ws://localhost:" + queryDict["port"] + "/"
		
		var username = queryDict["name"];
		var password = queryDict["password"];
		
		if (username == "") {
			username = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
			password = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
		}
		
		var ws;
		ws = new WebSocket(address)
		
		ws.onopen = function() {
			console.log("onopen");
			ws.send("control "+username+" "+password);
			ws.send("monitor -10 -10 -10 10 10 10 1");
			ws.send("update -10 -10 -10 10 10 10 0");
			ws.send("update -0.5 15.5 -0.5 15.5 31.5 15.5 0");
		}
		
		ws.onmessage = function(msg) {
			logbox.innerHTML = msg.data + "<br>" + logbox.innerHTML
			console.log(msg.data);
			ws.send("tick");
		}
		
		ws.onclose = function() {
			console.log("onclose");
			alert("server disconnected - you may as well close this tab");
		}
		
		ws.onerror = function(e) {
			console.log("onerror");
			console.log(e);
			alert(e);
		}
	
	</script>

	</body>

</html>
